zabbix_export:
  version: '5.4'
  date: '2021-05-28T01:04:17Z'
  groups:
    -
      uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
  templates:
    -
      uuid: f934f5e71db642c689ed2f945f73ce6c
      template: 'Cisco CISCO-PROCESS-MIB SNMP'
      name: 'Cisco CISCO-PROCESS-MIB SNMP'
      description: |
        Template Cisco CISCO-PROCESS-MIB
        
        MIBs used:
        CISCO-PROCESS-MIB
        
        Template tooling version used: 0.38
      groups:
        -
          name: Templates/Modules
      discovery_rules:
        -
          uuid: dc4773499a1d419caa5c2c96bd4afb7b
          name: 'CPU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.9.9.109.1.1.1.1.5]'
          key: cpu.discovery
          delay: 1h
          description: |
            If your IOS device has several CPUs, you must use CISCO-PROCESS-MIB and its object cpmCPUTotal5minRev from the table called cpmCPUTotalTable ,
            indexed with cpmCPUTotalIndex .
            This table allows CISCO-PROCESS-MIB to keep CPU statistics for different physical entities in the router,
            like different CPU chips, group of CPUs, or CPUs in different modules/cards.
            In case of a single CPU, cpmCPUTotalTable has only one entry.
          item_prototypes:
            -
              uuid: 884048f6fc414188b58341ecaca9aea3
              name: '#{#SNMPINDEX}: CPU utilization'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.9.9.109.1.1.1.1.8.{#SNMPINDEX}'
              key: 'system.cpu.util[cpmCPUTotal5minRev.{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: CISCO-PROCESS-MIB
                The cpmCPUTotal5minRev MIB object provides a more accurate view of the performance of the router over time than the MIB objects cpmCPUTotal1minRev and cpmCPUTotal5secRev . These MIB objects are not accurate because they look at CPU at one minute and five second intervals, respectively. These MIBs enable you to monitor the trends and plan the capacity of your network. The recommended baseline rising threshold for cpmCPUTotal5minRev is 90 percent. Depending on the platform, some routers that run at 90 percent, for example, 2500s, can exhibit performance degradation versus a high-end router, for example, the 7500 series, which can operate fine.
                Reference: http://www.cisco.com/c/en/us/support/docs/ip/simple-network-management-protocol-snmp/15215-collect-cpu-util-snmp.html
              tags:
                -
                  tag: Application
                  value: CPU
              trigger_prototypes:
                -
                  uuid: 52d3b9d4d52e4f289221f4b5ade177d7
                  expression: 'min(/Cisco CISCO-PROCESS-MIB SNMP/system.cpu.util[cpmCPUTotal5minRev.{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: '#{#SNMPINDEX}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    CPU utilization is too high. The system might be slow to respond.
                    Last value: {ITEM.LASTVALUE1}.
          graph_prototypes:
            -
              uuid: 6fed03a2555949178f96550fcdb449ca
              name: '#{#SNMPINDEX}: CPU utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Cisco CISCO-PROCESS-MIB SNMP'
                    key: 'system.cpu.util[cpmCPUTotal5minRev.{#SNMPINDEX}]'
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
